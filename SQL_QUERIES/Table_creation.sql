-- Create table for ASSAM_CROP_PRODUCTION in tgt_schema
CREATE TABLE tgt.assam_crop_production
(
    State_Name NVARCHAR(100),       -- Name of the state
    District_Name NVARCHAR(100),    -- Name of the district
    Crop_Year INT,                  -- Year of crop production
    Season NVARCHAR(50),            -- Season of crop production
    Crop NVARCHAR(100),             -- Name of the crop
    Area FLOAT,                     -- Area under cultivation
    Production FLOAT                -- Crop production
);

-- Create table for BIHAR_CROP_PRODUCTION in tgt_schema
CREATE TABLE tgt.bihar_crop_production
(
    State_Name NVARCHAR(100),       -- Name of the state
    District_Name NVARCHAR(100),    -- Name of the district
    Crop_Year INT,                  -- Year of crop production
    Season NVARCHAR(50),            -- Season of crop production
    Crop NVARCHAR(100),             -- Name of the crop
    Area FLOAT,                     -- Area under cultivation
    Production FLOAT                -- Crop production
);

-- Create table for CHANDIGARH_CROP_PRODUCTION in tgt_schema
CREATE TABLE tgt.chandigarh_crop_production
(
    State_Name NVARCHAR(100),       -- Name of the state
    District_Name NVARCHAR(100),    -- Name of the district
    Crop_Year INT,                  -- Year of crop production
    Season NVARCHAR(50),            -- Season of crop production
    Crop NVARCHAR(100),             -- Name of the crop
    Area FLOAT,                     -- Area under cultivation
    Production FLOAT                -- Crop production
);

-- Create table for CHHATTISGARH_CROP_PRODUCTION in tgt_schema
CREATE TABLE tgt.chhattisgarh_crop_production
(
    State_Name NVARCHAR(100),       -- Name of the state
    District_Name NVARCHAR(100),    -- Name of the district
    Crop_Year INT,                  -- Year of crop production
    Season NVARCHAR(50),            -- Season of crop production
    Crop NVARCHAR(100),             -- Name of the crop
    Area FLOAT,                     -- Area under cultivation
    Production FLOAT                -- Crop production
);

-- Create table for GOA_CROP_PRODUCTION in tgt_schema
CREATE TABLE tgt.goa_crop_production
(
    State_Name NVARCHAR(100),       -- Name of the state
    District_Name NVARCHAR(100),    -- Name of the district
    Crop_Year INT,                  -- Year of crop production
    Season NVARCHAR(50),            -- Season of crop production
    Crop NVARCHAR(100),             -- Name of the crop
    Area FLOAT,                     -- Area under cultivation
    Production FLOAT                -- Crop production
);

-- Create table for GUJARAT_CROP_PRODUCTION in tgt_schema
CREATE TABLE tgt.gujarat_crop_production
(
    State_Name NVARCHAR(100),       -- Name of the state
    District_Name NVARCHAR(100),    -- Name of the district
    Crop_Year INT,                  -- Year of crop production
    Season NVARCHAR(50),            -- Season of crop production
    Crop NVARCHAR(100),             -- Name of the crop
    Area FLOAT,                     -- Area under cultivation
    Production FLOAT                -- Crop production
);

-- Create table for HARYANA_CROP_PRODUCTION in tgt_schema
CREATE TABLE tgt.haryana_crop_production
(
    State_Name NVARCHAR(100),       -- Name of the state
    District_Name NVARCHAR(100),    -- Name of the district
    Crop_Year INT,                  -- Year of crop production
    Season NVARCHAR(50),            -- Season of crop production
    Crop NVARCHAR(100),             -- Name of the crop
    Area FLOAT,                     -- Area under cultivation
    Production FLOAT                -- Crop production
);

-- Create table for HIMACHAL_PRADESH_CROP_PRODUCTION in tgt_schema
CREATE TABLE tgt.himachal_pradesh_crop_production
(
    State_Name NVARCHAR(100),       -- Name of the state
    District_Name NVARCHAR(100),    -- Name of the district
    Crop_Year INT,                  -- Year of crop production
    Season NVARCHAR(50),            -- Season of crop production
    Crop NVARCHAR(100),             -- Name of the crop
    Area FLOAT,                     -- Area under cultivation
    Production FLOAT                -- Crop production
);

-- Create table for JAMMU_AND_KASHMIR_CROP_PRODUCTION in tgt_schema
CREATE TABLE tgt.jammu_and_kashmir_crop_production
(
    State_Name NVARCHAR(100),       -- Name of the state
    District_Name NVARCHAR(100),    -- Name of the district
    Crop_Year INT,                  -- Year of crop production
    Season NVARCHAR(50),            -- Season of crop production
    Crop NVARCHAR(100),             -- Name of the crop
    Area FLOAT,                     -- Area under cultivation
    Production FLOAT                -- Crop production
);

-- Create table for JHARKHAND_CROP_PRODUCTION in tgt_schema
CREATE TABLE tgt.jharkhand_crop_production
(
    State_Name NVARCHAR(100),       -- Name of the state
    District_Name NVARCHAR(100),    -- Name of the district
    Crop_Year INT,                  -- Year of crop production
    Season NVARCHAR(50),            -- Season of crop production
    Crop NVARCHAR(100),             -- Name of the crop
    Area FLOAT,                     -- Area under cultivation
    Production FLOAT                -- Crop production
);

-- Create table for KARNATAKA_CROP_PRODUCTION in tgt_schema
CREATE TABLE tgt.karnataka_crop_production
(
    State_Name NVARCHAR(100),       -- Name of the state
    District_Name NVARCHAR(100),    -- Name of the district
    Crop_Year INT,                  -- Year of crop production
    Season NVARCHAR(50),            -- Season of crop production
    Crop NVARCHAR(100),             -- Name of the crop
    Area FLOAT,                     -- Area under cultivation
    Production FLOAT                -- Crop production
);

-- Create table for KERALA_CROP_PRODUCTION in tgt_schema
CREATE TABLE tgt.kerala_crop_production
(
    State_Name NVARCHAR(100),       -- Name of the state
    District_Name NVARCHAR(100),    -- Name of the district
    Crop_Year INT,                  -- Year of crop production
    Season NVARCHAR(50),            -- Season of crop production
    Crop NVARCHAR(100),             -- Name of the crop
    Area FLOAT,                     -- Area under cultivation
    Production FLOAT                -- Crop production
);

-- Create table for MADHYA_PRADESH_CROP_PRODUCTION in tgt_schema
CREATE TABLE tgt.madhya_pradesh_crop_production
(
    State_Name NVARCHAR(100),       -- Name of the state
    District_Name NVARCHAR(100),    -- Name of the district
    Crop_Year INT,                  -- Year of crop production
    Season NVARCHAR(50),            -- Season of crop production
    Crop NVARCHAR(100),             -- Name of the crop
    Area FLOAT,                     -- Area under cultivation
    Production FLOAT                -- Crop production
);

-- Create table for MAHARASHTRA_CROP_PRODUCTION in tgt_schema
CREATE TABLE tgt.maharashtra_crop_production
(
    State_Name NVARCHAR(100),       -- Name of the state
    District_Name NVARCHAR(100),    -- Name of the district
    Crop_Year INT,                  -- Year of crop production
    Season NVARCHAR(50),            -- Season of crop production
    Crop NVARCHAR(100),             -- Name of the crop
    Area FLOAT,                     -- Area under cultivation
    Production FLOAT                -- Crop production
);

-- Create table for MEGHALAYA_CROP_PRODUCTION in tgt_schema
CREATE TABLE tgt.meghalaya_crop_production
(
    State_Name NVARCHAR(100),       -- Name of the state
    District_Name NVARCHAR(100),    -- Name of the district
    Crop_Year INT,                  -- Year of crop production
    Season NVARCHAR(50),            -- Season of crop production
    Crop NVARCHAR(100),             -- Name of the crop
    Area FLOAT,                     -- Area under cultivation
    Production FLOAT                -- Crop production
);

-- Create table for MIZORAM_CROP_PRODUCTION in tgt_schema
CREATE TABLE tgt.mizoram_crop_production
(
    State_Name NVARCHAR(100),       -- Name of the state
    District_Name NVARCHAR(100),    -- Name of the district
    Crop_Year INT,                  -- Year of crop production
    Season NVARCHAR(50),            -- Season of crop production
    Crop NVARCHAR(100),             -- Name of the crop
    Area FLOAT,                     -- Area under cultivation
    Production FLOAT                -- Crop production
);

-- Create table for NAGALAND_CROP_PRODUCTION in tgt_schema
CREATE TABLE tgt.nagaland_crop_production
(
    State_Name NVARCHAR(100),       -- Name of the state
    District_Name NVARCHAR(100),    -- Name of the district
    Crop_Year INT,                  -- Year of crop production
    Season NVARCHAR(50),            -- Season of crop production
    Crop NVARCHAR(100),             -- Name of the crop
    Area FLOAT,                     -- Area under cultivation
    Production FLOAT                -- Crop production
);

-- Create table for ODISHA_CROP_PRODUCTION in tgt_schema
CREATE TABLE tgt.odisha_crop_production
(
    State_Name NVARCHAR(100),       -- Name of the state
    District_Name NVARCHAR(100),    -- Name of the district
    Crop_Year INT,                  -- Year of crop production
    Season NVARCHAR(50),            -- Season of crop production
    Crop NVARCHAR(100),             -- Name of the crop
    Area FLOAT,                     -- Area under cultivation
    Production FLOAT                -- Crop production
);

-- Create table for PUNJAB_CROP_PRODUCTION in tgt_schema
CREATE TABLE tgt.punjab_crop_production
(
    State_Name NVARCHAR(100),       -- Name of the state
    District_Name NVARCHAR(100),    -- Name of the district
    Crop_Year INT,                  -- Year of crop production
    Season NVARCHAR(50),            -- Season of crop production
    Crop NVARCHAR(100),             -- Name of the crop
    Area FLOAT,                     -- Area under cultivation
    Production FLOAT                -- Crop production
);

-- Create table for RAJASTHAN_CROP_PRODUCTION in tgt_schema
CREATE TABLE tgt.rajasthan_crop_production
(
    State_Name NVARCHAR(100),       -- Name of the state
    District_Name NVARCHAR(100),    -- Name of the district
    Crop_Year INT,                  -- Year of crop production
    Season NVARCHAR(50),            -- Season of crop production
    Crop NVARCHAR(100),             -- Name of the crop
    Area FLOAT,                     -- Area under cultivation
    Production FLOAT                -- Crop production
);

-- Create table for SIKKIM_CROP_PRODUCTION in tgt_schema
CREATE TABLE tgt.sikkim_crop_production
(
    State_Name NVARCHAR(100),       -- Name of the state
    District_Name NVARCHAR(100),    -- Name of the district
    Crop_Year INT,                  -- Year of crop production
    Season NVARCHAR(50),            -- Season of crop production
    Crop NVARCHAR(100),             -- Name of the crop
    Area FLOAT,                     -- Area under cultivation
    Production FLOAT                -- Crop production
);

-- Create table for TAMIL_NADU_CROP_PRODUCTION in tgt_schema
CREATE TABLE tgt.tamil_nadu_crop_production
(
    State_Name NVARCHAR(100),       -- Name of the state
    District_Name NVARCHAR(100),    -- Name of the district
    Crop_Year INT,                  -- Year of crop production
    Season NVARCHAR(50),            -- Season of crop production
    Crop NVARCHAR(100),             -- Name of the crop
    Area FLOAT,                     -- Area under cultivation
    Production FLOAT                -- Crop production
);

-- Create table for TELANGANA_CROP_PRODUCTION in tgt_schema
CREATE TABLE tgt.telangana_crop_production
(
    State_Name NVARCHAR(100),       -- Name of the state
    District_Name NVARCHAR(100),    -- Name of the district
    Crop_Year INT,                  -- Year of crop production
    Season NVARCHAR(50),            -- Season of crop production
    Crop NVARCHAR(100),             -- Name of the crop
    Area FLOAT,                     -- Area under cultivation
    Production FLOAT                -- Crop production
);




-- Create table for TRIPURA_CROP_PRODUCTION in tgt_schema
CREATE TABLE tgt.tripura_crop_production
(
    State_Name NVARCHAR(100),       -- Name of the state
    District_Name NVARCHAR(100),    -- Name of the district
    Crop_Year INT,                  -- Year of crop production
    Season NVARCHAR(50),            -- Season of crop production
    Crop NVARCHAR(100),             -- Name of the crop
    Area FLOAT,                     -- Area under cultivation
    Production FLOAT                -- Crop production
);

-- Create table for UTTAR_PRADESH_CROP_PRODUCTION in tgt_schema
CREATE TABLE tgt.uttar_pradesh_crop_production
(
    State_Name NVARCHAR(100),       -- Name of the state
    District_Name NVARCHAR(100),    -- Name of the district
    Crop_Year INT,                  -- Year of crop production
    Season NVARCHAR(50),            -- Season of crop production
    Crop NVARCHAR(100),             -- Name of the crop
    Area FLOAT,                     -- Area under cultivation
    Production FLOAT                -- Crop production
);

-- Create table for UTTARAKHAND_CROP_PRODUCTION in tgt_schema
CREATE TABLE tgt.uttarakhand_crop_production
(
    State_Name NVARCHAR(100),       -- Name of the state
    District_Name NVARCHAR(100),    -- Name of the district
    Crop_Year INT,                  -- Year of crop production
    Season NVARCHAR(50),            -- Season of crop production
    Crop NVARCHAR(100),             -- Name of the crop
    Area FLOAT,                     -- Area under cultivation
    Production FLOAT                -- Crop production
);

-- Create table for WEST_BENGAL_CROP_PRODUCTION in tgt_schema
CREATE TABLE tgt.west_bengal_crop_production
(
    State_Name NVARCHAR(100),       -- Name of the state
    District_Name NVARCHAR(100),    -- Name of the district
    Crop_Year INT,                  -- Year of crop production
    Season NVARCHAR(50),            -- Season of crop production
    Crop NVARCHAR(100),             -- Name of the crop
    Area FLOAT,                     -- Area under cultivation
    Production FLOAT                -- Crop production
);

-- Create table for PUDUCHERRY_CROP_PRODUCTION in tgt_schema
CREATE TABLE tgt.puducherry_crop_production
(
    State_Name NVARCHAR(100),       -- Name of the state
    District_Name NVARCHAR(100),    -- Name of the district
    Crop_Year INT,                  -- Year of crop production
    Season NVARCHAR(50),            -- Season of crop production
    Crop NVARCHAR(100),             -- Name of the crop
    Area FLOAT,                     -- Area under cultivation
    Production FLOAT                -- Crop production
);

-- Create table for MANIPUR_CROP_PRODUCTION in tgt_schema
CREATE TABLE tgt.manipur_crop_production
(
    State_Name NVARCHAR(100),       -- Name of the state
    District_Name NVARCHAR(100),    -- Name of the district
    Crop_Year INT,                  -- Year of crop production
    Season NVARCHAR(50),            -- Season of crop production
    Crop NVARCHAR(100),             -- Name of the crop
    Area FLOAT,                     -- Area under cultivation
    Production FLOAT                -- Crop production
);

-- Create table for DADRA_AND_NAGAR_HAVERI_CROP_PRODUCTION in tgt_schema
CREATE TABLE tgt.dadra_and_nagar_haveli_crop_production
(
    State_Name NVARCHAR(100),       -- Name of the state
    District_Name NVARCHAR(100),    -- Name of the district
    Crop_Year INT,                  -- Year of crop production
    Season NVARCHAR(50),            -- Season of crop production
    Crop NVARCHAR(100),             -- Name of the crop
    Area FLOAT,                     -- Area under cultivation
    Production FLOAT                -- Crop production
);

-- Create table for ANDAMAN_AND_NICOBAR_ISLANDS_CROP_PRODUCTION in tgt_schema
CREATE TABLE tgt.andaman_and_nicobar_islands_crop_production
(
    State_Name NVARCHAR(100),       -- Name of the state
    District_Name NVARCHAR(100),    -- Name of the district
    Crop_Year INT,                  -- Year of crop production
    Season NVARCHAR(50),            -- Season of crop production
    Crop NVARCHAR(100),             -- Name of the crop
    Area FLOAT,                     -- Area under cultivation
    Production FLOAT                -- Crop production
);

-- Create table for ANDHRA_PRADESH_CROP_PRODUCTION in tgt_schema
CREATE TABLE tgt.andhra_pradesh_crop_production
(
    State_Name NVARCHAR(100),       -- Name of the state
    District_Name NVARCHAR(100),    -- Name of the district
    Crop_Year INT,                  -- Year of crop production
    Season NVARCHAR(50),            -- Season of crop production
    Crop NVARCHAR(100),             -- Name of the crop
    Area FLOAT,                     -- Area under cultivation
    Production FLOAT                -- Crop production
);

-- Create table for ARUNACHAL_PRADESH_CROP_PRODUCTION in tgt_schema
CREATE TABLE tgt.arunachal_pradesh_crop_production
(
    State_Name NVARCHAR(100),       -- Name of the state
    District_Name NVARCHAR(100),    -- Name of the district
    Crop_Year INT,                  -- Year of crop production
    Season NVARCHAR(50),            -- Season of crop production
    Crop NVARCHAR(100),             -- Name of the crop
    Area FLOAT,                     -- Area under cultivation
    Production FLOAT                -- Crop production
);

select * from tgt.DIM_GEOGRAPHY


CREATE TABLE tgt.DIM_GEOGRAPHY (
    DIM_GEOGRAPHY_ID INT PRIMARY KEY,   -- Surrogate Key without auto-increment
    STATE_NAME NVARCHAR(100),           -- State Name
    DISTRICT_NAME NVARCHAR(100),
	ID INT,-- District Name
    CREATE_DATE DATETIME DEFAULT GETDATE(),  -- Record creation timestamp
    UPDATE_DATE DATETIME DEFAULT GETDATE()   -- Record update timestamp
);

CREATE TABLE tgt.DIM_CROP (
    DIM_CROP_ID INT PRIMARY KEY,       -- Surrogate Key without auto-increment
    CROP NVARCHAR(100),				   -- Crop Name
	ID INT,
    CREATE_DATE DATETIME DEFAULT GETDATE(),  -- Record creation timestamp
    UPDATE_DATE DATETIME DEFAULT GETDATE()   -- Record update timestamp
);

CREATE TABLE tgt.DIM_SEASON (
    DIM_SEASON_ID INT PRIMARY KEY,     -- Surrogate Key without auto-increment
    SEASON NVARCHAR(50),
	ID INT,-- Season Name
    CREATE_DATE DATETIME DEFAULT GETDATE(),  -- Record creation timestamp
    UPDATE_DATE DATETIME DEFAULT GETDATE()   -- Record update timestamp
);

CREATE TABLE tgt.DIM_DATE (
    DIM_DATE_ID INT PRIMARY KEY,       -- Surrogate Key without auto-increment
    CROP_YEAR INT,
	ID INT,-- Year
    CREATE_DATE DATETIME DEFAULT GETDATE(),  -- Record creation timestamp
    UPDATE_DATE DATETIME DEFAULT GETDATE()   -- Record update timestamp
);

CREATE TABLE tgt.FACT_CROP_PRODUCTION (
    FACT_CROP_PRODUCTION_ID INT PRIMARY KEY,  -- Surrogate Key without auto-increment
    DIM_GEOGRAPHY_ID INT,                     -- Foreign Key to DIM_GEOGRAPHY
    DIM_CROP_ID INT,                          -- Foreign Key to DIM_CROP
    DIM_SEASON_ID INT,                        -- Foreign Key to DIM_SEASON
    DIM_DATE_ID INT,                          -- Foreign Key to DIM_DATE
	ID INT,-- Foreign Key to DIM_MEASURE (Optional)
    AREA DECIMAL(10, 2),                       -- Area
    PRODUCTION DECIMAL(20, 2),                 -- Production
    CROP_YEAR INT,                            -- Crop Year
    CREATE_DATE DATETIME DEFAULT GETDATE(),   -- Record creation timestamp
    UPDATE_DATE DATETIME DEFAULT GETDATE(),   -- Record update timestamp
    FOREIGN KEY (DIM_GEOGRAPHY_ID) REFERENCES tgt.DIM_GEOGRAPHY (DIM_GEOGRAPHY_ID),
    FOREIGN KEY (DIM_CROP_ID) REFERENCES tgt.DIM_CROP (DIM_CROP_ID),
    FOREIGN KEY (DIM_SEASON_ID) REFERENCES tgt.DIM_SEASON (DIM_SEASON_ID),
    FOREIGN KEY (DIM_DATE_ID) REFERENCES tgt.DIM_DATE (DIM_DATE_ID)
);

ALTER TABLE tgt.FACT_CROP_PRODUCTION
DROP COLUMN DIM_MEASURE_ID;



select * from tgt.FACT_CROP_PRODUCTION



















